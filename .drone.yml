---
kind: pipeline
type: docker
name: core

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: clone
  pull: always
  image: plugins/git:1
  settings:
    ref: master
    remote: https://github.com/owncloud/core.git
    sha: FETCH_HEAD

- name: translation-directory
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - echo 'noop'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-reader
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd 'l10n'
  - make l10n-read
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-push
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd 'l10n'
  - make l10n-push
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-pull
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd 'l10n'
  - make l10n-pull
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-writer
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd 'l10n'
  - make l10n-write
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-cleanup
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd 'l10n'
  - make l10n-clean
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-commit
  pull: always
  image: appleboy/drone-git-push:latest
  settings:
    author_email: devops@owncloud.com
    author_name: ownClouders
    branch: master
    commit: true
    commit_message: "[tx] updated from transifex"
    no_verify: true
    path: l10n
    remote: git@github.com:owncloud/core.git
    remote_name: upstream
    ssh_key:
      from_secret: git_push_ssh_key

trigger:
  event:
  - push
  ref:
  - refs/heads/master
  - refs/pull/**

---
kind: pipeline
type: docker
name: activity

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: clone
  pull: always
  image: plugins/git:1
  settings:
    ref: master
    remote: https://github.com/owncloud/activity.git
    sha: FETCH_HEAD

- name: translation-directory
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - mkdir -p './l10n'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-reader-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'activity' read
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-push-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d push -s --skip --no-interactive
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-pull-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d pull -a --skip --minimum-perc=75 -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-writer-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'activity' write
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-cleanup-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - find . -name *.po -type f -delete
  - find . -name *.pot -type f -delete
  - find . -name or_IN.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name uz.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name yo.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name ne.* -type f  -print0 | xargs -r -0 git rm -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-commit
  pull: always
  image: appleboy/drone-git-push:latest
  settings:
    author_email: devops@owncloud.com
    author_name: ownClouders
    branch: master
    commit: true
    commit_message: "[tx] updated from transifex"
    no_verify: true
    path: .
    remote: git@github.com:owncloud/activity.git
    remote_name: upstream
    ssh_key:
      from_secret: git_push_ssh_key

trigger:
  event:
  - push
  ref:
  - refs/heads/master
  - refs/pull/**

---
kind: pipeline
type: docker
name: announcementcenter

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: clone
  pull: always
  image: plugins/git:1
  settings:
    ref: master
    remote: https://github.com/owncloud/announcementcenter.git
    sha: FETCH_HEAD

- name: translation-directory
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - mkdir -p './l10n'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-reader-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'announcementcenter' read
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-push-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d push -s --skip --no-interactive
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-pull-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d pull -a --skip --minimum-perc=75 -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-writer-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'announcementcenter' write
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-cleanup-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - find . -name *.po -type f -delete
  - find . -name *.pot -type f -delete
  - find . -name or_IN.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name uz.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name yo.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name ne.* -type f  -print0 | xargs -r -0 git rm -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-commit
  pull: always
  image: appleboy/drone-git-push:latest
  settings:
    author_email: devops@owncloud.com
    author_name: ownClouders
    branch: master
    commit: true
    commit_message: "[tx] updated from transifex"
    no_verify: true
    path: .
    remote: git@github.com:owncloud/announcementcenter.git
    remote_name: upstream
    ssh_key:
      from_secret: git_push_ssh_key

trigger:
  event:
  - push
  ref:
  - refs/heads/master
  - refs/pull/**

---
kind: pipeline
type: docker
name: brute_force_protection

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: clone
  pull: always
  image: plugins/git:1
  settings:
    ref: master
    remote: https://github.com/owncloud/brute_force_protection.git
    sha: FETCH_HEAD

- name: translation-directory
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - mkdir -p './l10n'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-reader-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'brute_force_protection' read
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-push-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d push -s --skip --no-interactive
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-pull-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d pull -a --skip --minimum-perc=75 -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-writer-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'brute_force_protection' write
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-cleanup-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - find . -name *.po -type f -delete
  - find . -name *.pot -type f -delete
  - find . -name or_IN.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name uz.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name yo.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name ne.* -type f  -print0 | xargs -r -0 git rm -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-commit
  pull: always
  image: appleboy/drone-git-push:latest
  settings:
    author_email: devops@owncloud.com
    author_name: ownClouders
    branch: master
    commit: true
    commit_message: "[tx] updated from transifex"
    no_verify: true
    path: .
    remote: git@github.com:owncloud/brute_force_protection.git
    remote_name: upstream
    ssh_key:
      from_secret: git_push_ssh_key

trigger:
  event:
  - push
  ref:
  - refs/heads/master
  - refs/pull/**

---
kind: pipeline
type: docker
name: calendar

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: clone
  pull: always
  image: plugins/git:1
  settings:
    ref: master
    remote: https://github.com/owncloud/calendar.git
    sha: FETCH_HEAD

- name: translation-directory
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - mkdir -p './l10n'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-reader-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'calendar' read
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-push-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d push -s --skip --no-interactive
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-pull-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d pull -a --skip --minimum-perc=75 -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-writer-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'calendar' write
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-cleanup-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - find . -name *.po -type f -delete
  - find . -name *.pot -type f -delete
  - find . -name or_IN.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name uz.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name yo.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name ne.* -type f  -print0 | xargs -r -0 git rm -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-commit
  pull: always
  image: appleboy/drone-git-push:latest
  settings:
    author_email: devops@owncloud.com
    author_name: ownClouders
    branch: master
    commit: true
    commit_message: "[tx] updated from transifex"
    no_verify: true
    path: .
    remote: git@github.com:owncloud/calendar.git
    remote_name: upstream
    ssh_key:
      from_secret: git_push_ssh_key

trigger:
  event:
  - push
  ref:
  - refs/heads/master
  - refs/pull/**

---
kind: pipeline
type: docker
name: contacts

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: clone
  pull: always
  image: plugins/git:1
  settings:
    ref: master
    remote: https://github.com/owncloud/contacts.git
    sha: FETCH_HEAD

- name: translation-directory
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - mkdir -p './l10n'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-reader-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'contacts' read
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-push-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d push -s --skip --no-interactive
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-pull-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d pull -a --skip --minimum-perc=75 -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-writer-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'contacts' write
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-cleanup-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - find . -name *.po -type f -delete
  - find . -name *.pot -type f -delete
  - find . -name or_IN.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name uz.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name yo.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name ne.* -type f  -print0 | xargs -r -0 git rm -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-commit
  pull: always
  image: appleboy/drone-git-push:latest
  settings:
    author_email: devops@owncloud.com
    author_name: ownClouders
    branch: master
    commit: true
    commit_message: "[tx] updated from transifex"
    no_verify: true
    path: .
    remote: git@github.com:owncloud/contacts.git
    remote_name: upstream
    ssh_key:
      from_secret: git_push_ssh_key

trigger:
  event:
  - push
  ref:
  - refs/heads/master
  - refs/pull/**

---
kind: pipeline
type: docker
name: customgroups

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: clone
  pull: always
  image: plugins/git:1
  settings:
    ref: master
    remote: https://github.com/owncloud/customgroups.git
    sha: FETCH_HEAD

- name: translation-directory
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - mkdir -p './l10n'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-reader-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'customgroups' read
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-push-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d push -s --skip --no-interactive
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-pull-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d pull -a --skip --minimum-perc=75 -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-writer-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'customgroups' write
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-cleanup-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - find . -name *.po -type f -delete
  - find . -name *.pot -type f -delete
  - find . -name or_IN.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name uz.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name yo.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name ne.* -type f  -print0 | xargs -r -0 git rm -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-commit
  pull: always
  image: appleboy/drone-git-push:latest
  settings:
    author_email: devops@owncloud.com
    author_name: ownClouders
    branch: master
    commit: true
    commit_message: "[tx] updated from transifex"
    no_verify: true
    path: .
    remote: git@github.com:owncloud/customgroups.git
    remote_name: upstream
    ssh_key:
      from_secret: git_push_ssh_key

trigger:
  event:
  - push
  ref:
  - refs/heads/master
  - refs/pull/**

---
kind: pipeline
type: docker
name: diagnostics

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: clone
  pull: always
  image: plugins/git:1
  settings:
    ref: master
    remote: https://github.com/owncloud/diagnostics.git
    sha: FETCH_HEAD

- name: translation-directory
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - mkdir -p './l10n'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-reader-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'diagnostics' read
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-push-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d push -s --skip --no-interactive
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-pull-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d pull -a --skip --minimum-perc=75 -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-writer-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'diagnostics' write
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-cleanup-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - find . -name *.po -type f -delete
  - find . -name *.pot -type f -delete
  - find . -name or_IN.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name uz.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name yo.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name ne.* -type f  -print0 | xargs -r -0 git rm -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-commit
  pull: always
  image: appleboy/drone-git-push:latest
  settings:
    author_email: devops@owncloud.com
    author_name: ownClouders
    branch: master
    commit: true
    commit_message: "[tx] updated from transifex"
    no_verify: true
    path: .
    remote: git@github.com:owncloud/diagnostics.git
    remote_name: upstream
    ssh_key:
      from_secret: git_push_ssh_key

trigger:
  event:
  - push
  ref:
  - refs/heads/master
  - refs/pull/**

---
kind: pipeline
type: docker
name: external

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: clone
  pull: always
  image: plugins/git:1
  settings:
    ref: master
    remote: https://github.com/owncloud/external.git
    sha: FETCH_HEAD

- name: translation-directory
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - mkdir -p './l10n'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-reader-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'external' read
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-push-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d push -s --skip --no-interactive
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-pull-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d pull -a --skip --minimum-perc=75 -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-writer-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'external' write
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-cleanup-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - find . -name *.po -type f -delete
  - find . -name *.pot -type f -delete
  - find . -name or_IN.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name uz.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name yo.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name ne.* -type f  -print0 | xargs -r -0 git rm -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-commit
  pull: always
  image: appleboy/drone-git-push:latest
  settings:
    author_email: devops@owncloud.com
    author_name: ownClouders
    branch: master
    commit: true
    commit_message: "[tx] updated from transifex"
    no_verify: true
    path: .
    remote: git@github.com:owncloud/external.git
    remote_name: upstream
    ssh_key:
      from_secret: git_push_ssh_key

trigger:
  event:
  - push
  ref:
  - refs/heads/master
  - refs/pull/**

---
kind: pipeline
type: docker
name: files_antivirus

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: clone
  pull: always
  image: plugins/git:1
  settings:
    ref: master
    remote: https://github.com/owncloud/files_antivirus.git
    sha: FETCH_HEAD

- name: translation-directory
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - mkdir -p './l10n'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-reader-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'files_antivirus' read
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-push-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d push -s --skip --no-interactive
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-pull-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d pull -a --skip --minimum-perc=75 -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-writer-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'files_antivirus' write
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-cleanup-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - find . -name *.po -type f -delete
  - find . -name *.pot -type f -delete
  - find . -name or_IN.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name uz.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name yo.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name ne.* -type f  -print0 | xargs -r -0 git rm -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-commit
  pull: always
  image: appleboy/drone-git-push:latest
  settings:
    author_email: devops@owncloud.com
    author_name: ownClouders
    branch: master
    commit: true
    commit_message: "[tx] updated from transifex"
    no_verify: true
    path: .
    remote: git@github.com:owncloud/files_antivirus.git
    remote_name: upstream
    ssh_key:
      from_secret: git_push_ssh_key

trigger:
  event:
  - push
  ref:
  - refs/heads/master
  - refs/pull/**

---
kind: pipeline
type: docker
name: files_external_dropbox

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: clone
  pull: always
  image: plugins/git:1
  settings:
    ref: master
    remote: https://github.com/owncloud/files_external_dropbox.git
    sha: FETCH_HEAD

- name: translation-directory
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - mkdir -p './l10n'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-reader-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'files_external_dropbox' read
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-push-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d push -s --skip --no-interactive
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-pull-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d pull -a --skip --minimum-perc=75 -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-writer-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'files_external_dropbox' write
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-cleanup-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - find . -name *.po -type f -delete
  - find . -name *.pot -type f -delete
  - find . -name or_IN.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name uz.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name yo.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name ne.* -type f  -print0 | xargs -r -0 git rm -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-commit
  pull: always
  image: appleboy/drone-git-push:latest
  settings:
    author_email: devops@owncloud.com
    author_name: ownClouders
    branch: master
    commit: true
    commit_message: "[tx] updated from transifex"
    no_verify: true
    path: .
    remote: git@github.com:owncloud/files_external_dropbox.git
    remote_name: upstream
    ssh_key:
      from_secret: git_push_ssh_key

trigger:
  event:
  - push
  ref:
  - refs/heads/master
  - refs/pull/**

---
kind: pipeline
type: docker
name: files_external_ftp

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: clone
  pull: always
  image: plugins/git:1
  settings:
    ref: master
    remote: https://github.com/owncloud/files_external_ftp.git
    sha: FETCH_HEAD

- name: translation-directory
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - mkdir -p './l10n'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-reader-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'files_external_ftp' read
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-push-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d push -s --skip --no-interactive
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-pull-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d pull -a --skip --minimum-perc=75 -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-writer-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'files_external_ftp' write
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-cleanup-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - find . -name *.po -type f -delete
  - find . -name *.pot -type f -delete
  - find . -name or_IN.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name uz.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name yo.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name ne.* -type f  -print0 | xargs -r -0 git rm -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-commit
  pull: always
  image: appleboy/drone-git-push:latest
  settings:
    author_email: devops@owncloud.com
    author_name: ownClouders
    branch: master
    commit: true
    commit_message: "[tx] updated from transifex"
    no_verify: true
    path: .
    remote: git@github.com:owncloud/files_external_ftp.git
    remote_name: upstream
    ssh_key:
      from_secret: git_push_ssh_key

trigger:
  event:
  - push
  ref:
  - refs/heads/master
  - refs/pull/**

---
kind: pipeline
type: docker
name: files_external_gdrive

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: clone
  pull: always
  image: plugins/git:1
  settings:
    ref: master
    remote: https://github.com/owncloud/files_external_gdrive.git
    sha: FETCH_HEAD

- name: translation-directory
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - mkdir -p './l10n'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-reader-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'files_external_gdrive' read
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-push-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d push -s --skip --no-interactive
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-pull-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d pull -a --skip --minimum-perc=75 -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-writer-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'files_external_gdrive' write
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-cleanup-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - find . -name *.po -type f -delete
  - find . -name *.pot -type f -delete
  - find . -name or_IN.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name uz.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name yo.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name ne.* -type f  -print0 | xargs -r -0 git rm -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-commit
  pull: always
  image: appleboy/drone-git-push:latest
  settings:
    author_email: devops@owncloud.com
    author_name: ownClouders
    branch: master
    commit: true
    commit_message: "[tx] updated from transifex"
    no_verify: true
    path: .
    remote: git@github.com:owncloud/files_external_gdrive.git
    remote_name: upstream
    ssh_key:
      from_secret: git_push_ssh_key

trigger:
  event:
  - push
  ref:
  - refs/heads/master
  - refs/pull/**

---
kind: pipeline
type: docker
name: files_paperhive

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: clone
  pull: always
  image: plugins/git:1
  settings:
    ref: master
    remote: https://github.com/owncloud/files_paperhive.git
    sha: FETCH_HEAD

- name: translation-directory
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - mkdir -p './l10n'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-reader-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'files_paperhive' read
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-push-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d push -s --skip --no-interactive
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-pull-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d pull -a --skip --minimum-perc=75 -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-writer-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'files_paperhive' write
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-cleanup-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - find . -name *.po -type f -delete
  - find . -name *.pot -type f -delete
  - find . -name or_IN.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name uz.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name yo.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name ne.* -type f  -print0 | xargs -r -0 git rm -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-commit
  pull: always
  image: appleboy/drone-git-push:latest
  settings:
    author_email: devops@owncloud.com
    author_name: ownClouders
    branch: master
    commit: true
    commit_message: "[tx] updated from transifex"
    no_verify: true
    path: .
    remote: git@github.com:owncloud/files_paperhive.git
    remote_name: upstream
    ssh_key:
      from_secret: git_push_ssh_key

trigger:
  event:
  - push
  ref:
  - refs/heads/master
  - refs/pull/**

---
kind: pipeline
type: docker
name: files_texteditor

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: clone
  pull: always
  image: plugins/git:1
  settings:
    ref: master
    remote: https://github.com/owncloud/files_texteditor.git
    sha: FETCH_HEAD

- name: translation-directory
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - mkdir -p './l10n'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-reader-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'files_texteditor' read
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-push-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d push -s --skip --no-interactive
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-pull-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d pull -a --skip --minimum-perc=75 -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-writer-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'files_texteditor' write
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-cleanup-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - find . -name *.po -type f -delete
  - find . -name *.pot -type f -delete
  - find . -name or_IN.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name uz.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name yo.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name ne.* -type f  -print0 | xargs -r -0 git rm -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-commit
  pull: always
  image: appleboy/drone-git-push:latest
  settings:
    author_email: devops@owncloud.com
    author_name: ownClouders
    branch: master
    commit: true
    commit_message: "[tx] updated from transifex"
    no_verify: true
    path: .
    remote: git@github.com:owncloud/files_texteditor.git
    remote_name: upstream
    ssh_key:
      from_secret: git_push_ssh_key

trigger:
  event:
  - push
  ref:
  - refs/heads/master
  - refs/pull/**

---
kind: pipeline
type: docker
name: firstrunwizard

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: clone
  pull: always
  image: plugins/git:1
  settings:
    ref: master
    remote: https://github.com/owncloud/firstrunwizard.git
    sha: FETCH_HEAD

- name: translation-directory
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - mkdir -p './l10n'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-reader-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'firstrunwizard' read
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-push-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d push -s --skip --no-interactive
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-pull-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d pull -a --skip --minimum-perc=75 -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-writer-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'firstrunwizard' write
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-cleanup-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - find . -name *.po -type f -delete
  - find . -name *.pot -type f -delete
  - find . -name or_IN.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name uz.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name yo.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name ne.* -type f  -print0 | xargs -r -0 git rm -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-commit
  pull: always
  image: appleboy/drone-git-push:latest
  settings:
    author_email: devops@owncloud.com
    author_name: ownClouders
    branch: master
    commit: true
    commit_message: "[tx] updated from transifex"
    no_verify: true
    path: .
    remote: git@github.com:owncloud/firstrunwizard.git
    remote_name: upstream
    ssh_key:
      from_secret: git_push_ssh_key

trigger:
  event:
  - push
  ref:
  - refs/heads/master
  - refs/pull/**

---
kind: pipeline
type: docker
name: guests

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: clone
  pull: always
  image: plugins/git:1
  settings:
    ref: master
    remote: https://github.com/owncloud/guests.git
    sha: FETCH_HEAD

- name: translation-directory
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - mkdir -p './l10n'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-reader-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'guests' read
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-push-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d push -s --skip --no-interactive
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-pull-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d pull -a --skip --minimum-perc=75 -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-writer-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'guests' write
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-cleanup-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - find . -name *.po -type f -delete
  - find . -name *.pot -type f -delete
  - find . -name or_IN.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name uz.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name yo.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name ne.* -type f  -print0 | xargs -r -0 git rm -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-commit
  pull: always
  image: appleboy/drone-git-push:latest
  settings:
    author_email: devops@owncloud.com
    author_name: ownClouders
    branch: master
    commit: true
    commit_message: "[tx] updated from transifex"
    no_verify: true
    path: .
    remote: git@github.com:owncloud/guests.git
    remote_name: upstream
    ssh_key:
      from_secret: git_push_ssh_key

trigger:
  event:
  - push
  ref:
  - refs/heads/master
  - refs/pull/**

---
kind: pipeline
type: docker
name: impersonate

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: clone
  pull: always
  image: plugins/git:1
  settings:
    ref: master
    remote: https://github.com/owncloud/impersonate.git
    sha: FETCH_HEAD

- name: translation-directory
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - mkdir -p './l10n'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-reader-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'impersonate' read
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-push-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d push -s --skip --no-interactive
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-pull-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d pull -a --skip --minimum-perc=75 -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-writer-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'impersonate' write
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-cleanup-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - find . -name *.po -type f -delete
  - find . -name *.pot -type f -delete
  - find . -name or_IN.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name uz.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name yo.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name ne.* -type f  -print0 | xargs -r -0 git rm -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-commit
  pull: always
  image: appleboy/drone-git-push:latest
  settings:
    author_email: devops@owncloud.com
    author_name: ownClouders
    branch: master
    commit: true
    commit_message: "[tx] updated from transifex"
    no_verify: true
    path: .
    remote: git@github.com:owncloud/impersonate.git
    remote_name: upstream
    ssh_key:
      from_secret: git_push_ssh_key

trigger:
  event:
  - push
  ref:
  - refs/heads/master
  - refs/pull/**

---
kind: pipeline
type: docker
name: notes

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: clone
  pull: always
  image: plugins/git:1
  settings:
    ref: master
    remote: https://github.com/owncloud/notes.git
    sha: FETCH_HEAD

- name: translation-directory
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - mkdir -p './l10n'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-reader-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'notes' read
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-push-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d push -s --skip --no-interactive
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-pull-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d pull -a --skip --minimum-perc=75 -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-writer-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'notes' write
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-cleanup-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - find . -name *.po -type f -delete
  - find . -name *.pot -type f -delete
  - find . -name or_IN.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name uz.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name yo.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name ne.* -type f  -print0 | xargs -r -0 git rm -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-commit
  pull: always
  image: appleboy/drone-git-push:latest
  settings:
    author_email: devops@owncloud.com
    author_name: ownClouders
    branch: master
    commit: true
    commit_message: "[tx] updated from transifex"
    no_verify: true
    path: .
    remote: git@github.com:owncloud/notes.git
    remote_name: upstream
    ssh_key:
      from_secret: git_push_ssh_key

trigger:
  event:
  - push
  ref:
  - refs/heads/master
  - refs/pull/**

---
kind: pipeline
type: docker
name: notifications

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: clone
  pull: always
  image: plugins/git:1
  settings:
    ref: master
    remote: https://github.com/owncloud/notifications.git
    sha: FETCH_HEAD

- name: translation-directory
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - mkdir -p './l10n'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-reader-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'notifications' read
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-push-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d push -s --skip --no-interactive
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-pull-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d pull -a --skip --minimum-perc=75 -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-writer-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'notifications' write
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-cleanup-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - find . -name *.po -type f -delete
  - find . -name *.pot -type f -delete
  - find . -name or_IN.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name uz.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name yo.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name ne.* -type f  -print0 | xargs -r -0 git rm -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-commit
  pull: always
  image: appleboy/drone-git-push:latest
  settings:
    author_email: devops@owncloud.com
    author_name: ownClouders
    branch: master
    commit: true
    commit_message: "[tx] updated from transifex"
    no_verify: true
    path: .
    remote: git@github.com:owncloud/notifications.git
    remote_name: upstream
    ssh_key:
      from_secret: git_push_ssh_key

trigger:
  event:
  - push
  ref:
  - refs/heads/master
  - refs/pull/**

---
kind: pipeline
type: docker
name: oauth2

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: clone
  pull: always
  image: plugins/git:1
  settings:
    ref: master
    remote: https://github.com/owncloud/oauth2.git
    sha: FETCH_HEAD

- name: translation-directory
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - mkdir -p './l10n'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-reader-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'oauth2' read
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-push-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d push -s --skip --no-interactive
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-pull-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d pull -a --skip --minimum-perc=75 -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-writer-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'oauth2' write
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-cleanup-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - find . -name *.po -type f -delete
  - find . -name *.pot -type f -delete
  - find . -name or_IN.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name uz.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name yo.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name ne.* -type f  -print0 | xargs -r -0 git rm -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-commit
  pull: always
  image: appleboy/drone-git-push:latest
  settings:
    author_email: devops@owncloud.com
    author_name: ownClouders
    branch: master
    commit: true
    commit_message: "[tx] updated from transifex"
    no_verify: true
    path: .
    remote: git@github.com:owncloud/oauth2.git
    remote_name: upstream
    ssh_key:
      from_secret: git_push_ssh_key

trigger:
  event:
  - push
  ref:
  - refs/heads/master
  - refs/pull/**

---
kind: pipeline
type: docker
name: password_policy

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: clone
  pull: always
  image: plugins/git:1
  settings:
    ref: master
    remote: https://github.com/owncloud/password_policy.git
    sha: FETCH_HEAD

- name: translation-directory
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - mkdir -p './l10n'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-reader-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'password_policy' read
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-push-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d push -s --skip --no-interactive
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-pull-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d pull -a --skip --minimum-perc=75 -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-writer-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'password_policy' write
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-cleanup-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - find . -name *.po -type f -delete
  - find . -name *.pot -type f -delete
  - find . -name or_IN.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name uz.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name yo.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name ne.* -type f  -print0 | xargs -r -0 git rm -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-commit
  pull: always
  image: appleboy/drone-git-push:latest
  settings:
    author_email: devops@owncloud.com
    author_name: ownClouders
    branch: master
    commit: true
    commit_message: "[tx] updated from transifex"
    no_verify: true
    path: .
    remote: git@github.com:owncloud/password_policy.git
    remote_name: upstream
    ssh_key:
      from_secret: git_push_ssh_key

trigger:
  event:
  - push
  ref:
  - refs/heads/master
  - refs/pull/**

---
kind: pipeline
type: docker
name: richdocuments

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: clone
  pull: always
  image: plugins/git:1
  settings:
    ref: master
    remote: https://github.com/owncloud/richdocuments.git
    sha: FETCH_HEAD

- name: translation-directory
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - mkdir -p './l10n'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-reader-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'richdocuments' read
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-push-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d push -s --skip --no-interactive
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-pull-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d pull -a --skip --minimum-perc=75 -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-writer-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'richdocuments' write
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-cleanup-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - find . -name *.po -type f -delete
  - find . -name *.pot -type f -delete
  - find . -name or_IN.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name uz.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name yo.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name ne.* -type f  -print0 | xargs -r -0 git rm -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-commit
  pull: always
  image: appleboy/drone-git-push:latest
  settings:
    author_email: devops@owncloud.com
    author_name: ownClouders
    branch: master
    commit: true
    commit_message: "[tx] updated from transifex"
    no_verify: true
    path: .
    remote: git@github.com:owncloud/richdocuments.git
    remote_name: upstream
    ssh_key:
      from_secret: git_push_ssh_key

trigger:
  event:
  - push
  ref:
  - refs/heads/master
  - refs/pull/**

---
kind: pipeline
type: docker
name: tasks

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: clone
  pull: always
  image: plugins/git:1
  settings:
    ref: master
    remote: https://github.com/owncloud/tasks.git
    sha: FETCH_HEAD

- name: translation-directory
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - mkdir -p './l10n'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-reader-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'tasks' read
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-push-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d push -s --skip --no-interactive
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-pull-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d pull -a --skip --minimum-perc=75 -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-writer-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'tasks' write
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-cleanup-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - find . -name *.po -type f -delete
  - find . -name *.pot -type f -delete
  - find . -name or_IN.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name uz.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name yo.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name ne.* -type f  -print0 | xargs -r -0 git rm -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-commit
  pull: always
  image: appleboy/drone-git-push:latest
  settings:
    author_email: devops@owncloud.com
    author_name: ownClouders
    branch: master
    commit: true
    commit_message: "[tx] updated from transifex"
    no_verify: true
    path: .
    remote: git@github.com:owncloud/tasks.git
    remote_name: upstream
    ssh_key:
      from_secret: git_push_ssh_key

trigger:
  event:
  - push
  ref:
  - refs/heads/master
  - refs/pull/**

---
kind: pipeline
type: docker
name: templateeditor

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: clone
  pull: always
  image: plugins/git:1
  settings:
    ref: master
    remote: https://github.com/owncloud/templateeditor.git
    sha: FETCH_HEAD

- name: translation-directory
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - mkdir -p './l10n'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-reader-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'templateeditor' read
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-push-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d push -s --skip --no-interactive
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-pull-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d pull -a --skip --minimum-perc=75 -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-writer-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'templateeditor' write
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-cleanup-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - find . -name *.po -type f -delete
  - find . -name *.pot -type f -delete
  - find . -name or_IN.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name uz.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name yo.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name ne.* -type f  -print0 | xargs -r -0 git rm -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-commit
  pull: always
  image: appleboy/drone-git-push:latest
  settings:
    author_email: devops@owncloud.com
    author_name: ownClouders
    branch: master
    commit: true
    commit_message: "[tx] updated from transifex"
    no_verify: true
    path: .
    remote: git@github.com:owncloud/templateeditor.git
    remote_name: upstream
    ssh_key:
      from_secret: git_push_ssh_key

trigger:
  event:
  - push
  ref:
  - refs/heads/master
  - refs/pull/**

---
kind: pipeline
type: docker
name: twofactor_backup_codes

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: clone
  pull: always
  image: plugins/git:1
  settings:
    ref: master
    remote: https://github.com/owncloud/twofactor_backup_codes.git
    sha: FETCH_HEAD

- name: translation-directory
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - mkdir -p './l10n'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-reader-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'twofactor_backup_codes' read
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-push-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d push -s --skip --no-interactive
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-pull-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d pull -a --skip --minimum-perc=75 -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-writer-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'twofactor_backup_codes' write
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-cleanup-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - find . -name *.po -type f -delete
  - find . -name *.pot -type f -delete
  - find . -name or_IN.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name uz.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name yo.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name ne.* -type f  -print0 | xargs -r -0 git rm -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-commit
  pull: always
  image: appleboy/drone-git-push:latest
  settings:
    author_email: devops@owncloud.com
    author_name: ownClouders
    branch: master
    commit: true
    commit_message: "[tx] updated from transifex"
    no_verify: true
    path: .
    remote: git@github.com:owncloud/twofactor_backup_codes.git
    remote_name: upstream
    ssh_key:
      from_secret: git_push_ssh_key

trigger:
  event:
  - push
  ref:
  - refs/heads/master
  - refs/pull/**

---
kind: pipeline
type: docker
name: twofactor_privacyidea

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: clone
  pull: always
  image: plugins/git:1
  settings:
    ref: master
    remote: https://github.com/privacyidea/privacyidea-owncloud-app.git
    sha: FETCH_HEAD

- name: translation-directory
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - mkdir -p './twofactor_privacyidea/l10n'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-reader-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './twofactor_privacyidea/l10n'
  - l10n 'twofactor_privacyidea' read
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-push-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './twofactor_privacyidea/l10n'
  - tx -d push -s --skip --no-interactive
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-pull-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './twofactor_privacyidea/l10n'
  - tx -d pull -a --skip --minimum-perc=75 -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-writer-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './twofactor_privacyidea/l10n'
  - l10n 'twofactor_privacyidea' write
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-cleanup-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './twofactor_privacyidea/l10n'
  - find . -name *.po -type f -delete
  - find . -name *.pot -type f -delete
  - find . -name or_IN.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name uz.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name yo.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name ne.* -type f  -print0 | xargs -r -0 git rm -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-commit
  pull: always
  image: appleboy/drone-git-push:latest
  settings:
    author_email: devops@owncloud.com
    author_name: ownClouders
    branch: master
    commit: true
    commit_message: "[tx] updated from transifex"
    no_verify: true
    path: ./twofactor_privacyidea
    remote: git@github.com:privacyidea/privacyidea-owncloud-app.git
    remote_name: upstream
    ssh_key:
      from_secret: git_push_ssh_key

trigger:
  event:
  - push
  ref:
  - refs/heads/master
  - refs/pull/**

---
kind: pipeline
type: docker
name: twofactor_totp

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: clone
  pull: always
  image: plugins/git:1
  settings:
    ref: master
    remote: https://github.com/owncloud/twofactor_totp.git
    sha: FETCH_HEAD

- name: translation-directory
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - mkdir -p './l10n'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-reader-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'twofactor_totp' read
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-push-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d push -s --skip --no-interactive
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-pull-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d pull -a --skip --minimum-perc=75 -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-writer-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'twofactor_totp' write
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-cleanup-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - find . -name *.po -type f -delete
  - find . -name *.pot -type f -delete
  - find . -name or_IN.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name uz.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name yo.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name ne.* -type f  -print0 | xargs -r -0 git rm -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-commit
  pull: always
  image: appleboy/drone-git-push:latest
  settings:
    author_email: devops@owncloud.com
    author_name: ownClouders
    branch: master
    commit: true
    commit_message: "[tx] updated from transifex"
    no_verify: true
    path: .
    remote: git@github.com:owncloud/twofactor_totp.git
    remote_name: upstream
    ssh_key:
      from_secret: git_push_ssh_key

trigger:
  event:
  - push
  ref:
  - refs/heads/master
  - refs/pull/**

---
kind: pipeline
type: docker
name: user_ldap

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: clone
  pull: always
  image: plugins/git:1
  settings:
    ref: master
    remote: https://github.com/owncloud/user_ldap.git
    sha: FETCH_HEAD

- name: translation-directory
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - mkdir -p './l10n'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-reader-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'user_ldap' read
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-push-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d push -s --skip --no-interactive
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-pull-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d pull -a --skip --minimum-perc=75 -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-writer-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'user_ldap' write
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-cleanup-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - find . -name *.po -type f -delete
  - find . -name *.pot -type f -delete
  - find . -name or_IN.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name uz.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name yo.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name ne.* -type f  -print0 | xargs -r -0 git rm -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-commit
  pull: always
  image: appleboy/drone-git-push:latest
  settings:
    author_email: devops@owncloud.com
    author_name: ownClouders
    branch: master
    commit: true
    commit_message: "[tx] updated from transifex"
    no_verify: true
    path: .
    remote: git@github.com:owncloud/user_ldap.git
    remote_name: upstream
    ssh_key:
      from_secret: git_push_ssh_key

trigger:
  event:
  - push
  ref:
  - refs/heads/master
  - refs/pull/**

---
kind: pipeline
type: docker
name: user_management

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: clone
  pull: always
  image: plugins/git:1
  settings:
    ref: master
    remote: https://github.com/owncloud/user_management.git
    sha: FETCH_HEAD

- name: translation-directory
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - mkdir -p './l10n'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-reader-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'user_management' read
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-push-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d push -s --skip --no-interactive
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-pull-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d pull -a --skip --minimum-perc=75 -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-writer-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'user_management' write
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-cleanup-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - find . -name *.po -type f -delete
  - find . -name *.pot -type f -delete
  - find . -name or_IN.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name uz.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name yo.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name ne.* -type f  -print0 | xargs -r -0 git rm -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-commit
  pull: always
  image: appleboy/drone-git-push:latest
  settings:
    author_email: devops@owncloud.com
    author_name: ownClouders
    branch: master
    commit: true
    commit_message: "[tx] updated from transifex"
    no_verify: true
    path: .
    remote: git@github.com:owncloud/user_management.git
    remote_name: upstream
    ssh_key:
      from_secret: git_push_ssh_key

trigger:
  event:
  - push
  ref:
  - refs/heads/master
  - refs/pull/**

---
kind: pipeline
type: docker
name: encryption

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: clone
  pull: always
  image: plugins/git:1
  settings:
    ref: master
    remote: https://github.com/owncloud/encryption.git
    sha: FETCH_HEAD

- name: translation-directory
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - mkdir -p './l10n'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-reader-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'encryption' read
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-push-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d push -s --skip --no-interactive
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-pull-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - tx -d pull -a --skip --minimum-perc=75 -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-writer-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - l10n 'encryption' write
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-cleanup-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './l10n'
  - find . -name *.po -type f -delete
  - find . -name *.pot -type f -delete
  - find . -name or_IN.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name uz.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name yo.* -type f  -print0 | xargs -r -0 git rm -f
  - find . -name ne.* -type f  -print0 | xargs -r -0 git rm -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-commit
  pull: always
  image: appleboy/drone-git-push:latest
  settings:
    author_email: devops@owncloud.com
    author_name: ownClouders
    branch: master
    commit: true
    commit_message: "[tx] updated from transifex"
    no_verify: true
    path: .
    remote: git@github.com:owncloud/encryption.git
    remote_name: upstream
    ssh_key:
      from_secret: git_push_ssh_key

trigger:
  event:
  - push
  ref:
  - refs/heads/master
  - refs/pull/**

---
kind: pipeline
type: docker
name: phoenix

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: clone
  pull: always
  image: plugins/git:1
  settings:
    ref: master
    remote: https://github.com/owncloud/phoenix.git
    sha: FETCH_HEAD

- name: translation-directory
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - echo 'noop'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-reader
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd '.'
  - make l10n-read
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-push
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd '.'
  - make l10n-push
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-pull
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd '.'
  - make l10n-pull
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-writer
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd '.'
  - make l10n-write
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-cleanup
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd '.'
  - make l10n-clean
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-commit
  pull: always
  image: appleboy/drone-git-push:latest
  settings:
    author_email: devops@owncloud.com
    author_name: ownClouders
    branch: master
    commit: true
    commit_message: "[tx] updated from transifex"
    no_verify: true
    path: .
    remote: git@github.com:owncloud/phoenix.git
    remote_name: upstream
    ssh_key:
      from_secret: git_push_ssh_key

trigger:
  event:
  - push
  ref:
  - refs/heads/master
  - refs/pull/**

---
kind: pipeline
type: docker
name: windows_phone

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: clone
  pull: always
  image: plugins/git:1
  settings:
    ref: master
    remote: https://github.com/owncloud/OwncloudUniversal.git
    sha: FETCH_HEAD

- name: translation-directory
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - echo 'noop'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-reader
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd '.'
  - make l10n-read
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-push
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd '.'
  - make l10n-push
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-pull
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd '.'
  - make l10n-pull
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-writer
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd '.'
  - make l10n-write
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-cleanup
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd '.'
  - make l10n-clean
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-commit
  pull: always
  image: appleboy/drone-git-push:latest
  settings:
    author_email: devops@owncloud.com
    author_name: ownClouders
    branch: master
    commit: true
    commit_message: "[tx] updated from transifex"
    no_verify: true
    path: .
    remote: git@github.com:owncloud/OwncloudUniversal.git
    remote_name: upstream
    ssh_key:
      from_secret: git_push_ssh_key

trigger:
  event:
  - push
  ref:
  - refs/heads/master
  - refs/pull/**

---
kind: pipeline
type: docker
name: ios-app

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: clone
  pull: always
  image: plugins/git:1
  settings:
    ref: translation-sync
    remote: https://github.com/owncloud/ios-app.git
    sha: FETCH_HEAD

- name: translation-directory
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - echo 'noop'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-reader-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - echo 'noop'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-push-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './.'
  - tx -d push -s --skip --no-interactive
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-pull-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './.'
  - tx -d pull -a --skip --minimum-perc=75 -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-writer-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - echo 'noop'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-cleanup-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - echo 'noop'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-commit
  pull: always
  image: appleboy/drone-git-push:latest
  settings:
    author_email: devops@owncloud.com
    author_name: ownClouders
    branch: translation-sync
    commit: true
    commit_message: "[tx] updated from transifex"
    no_verify: true
    path: .
    remote: git@github.com:owncloud/ios-app.git
    remote_name: upstream
    ssh_key:
      from_secret: git_push_ssh_key

trigger:
  event:
  - push
  ref:
  - refs/heads/master
  - refs/pull/**

---
kind: pipeline
type: docker
name: ios-sdk

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: clone
  pull: always
  image: plugins/git:1
  settings:
    ref: translation-sync
    remote: https://github.com/owncloud/ios-sdk.git
    sha: FETCH_HEAD

- name: translation-directory
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - echo 'noop'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-reader-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - echo 'noop'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-push-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './.'
  - tx -d push -s --skip --no-interactive
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-pull-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './.'
  - tx -d pull -a --skip --minimum-perc=75 -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-writer-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - echo 'noop'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-cleanup-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - echo 'noop'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-commit
  pull: always
  image: appleboy/drone-git-push:latest
  settings:
    author_email: devops@owncloud.com
    author_name: ownClouders
    branch: translation-sync
    commit: true
    commit_message: "[tx] updated from transifex"
    no_verify: true
    path: .
    remote: git@github.com:owncloud/ios-sdk.git
    remote_name: upstream
    ssh_key:
      from_secret: git_push_ssh_key

trigger:
  event:
  - push
  ref:
  - refs/heads/master
  - refs/pull/**

---
kind: pipeline
type: docker
name: ios-old

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: clone
  pull: always
  image: plugins/git:1
  settings:
    ref: master
    remote: https://github.com/owncloud/ios.git
    sha: FETCH_HEAD

- name: translation-directory
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - echo 'noop'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-reader-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - echo 'noop'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-push-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './.'
  - tx -d push -s --skip --no-interactive
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-pull-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './.'
  - tx -d pull -a --skip --minimum-perc=75 -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-writer-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - echo 'noop'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-cleanup-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - echo 'noop'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-commit
  pull: always
  image: appleboy/drone-git-push:latest
  settings:
    author_email: devops@owncloud.com
    author_name: ownClouders
    branch: master
    commit: true
    commit_message: "[tx] updated from transifex"
    no_verify: true
    path: .
    remote: git@github.com:owncloud/ios.git
    remote_name: upstream
    ssh_key:
      from_secret: git_push_ssh_key

trigger:
  event:
  - push
  ref:
  - refs/heads/master
  - refs/pull/**

---
kind: pipeline
type: docker
name: android

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: clone
  pull: always
  image: plugins/git:1
  settings:
    ref: master
    remote: https://github.com/owncloud/android.git
    sha: FETCH_HEAD

- name: translation-directory
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - echo 'noop'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-reader-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - echo 'noop'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-push-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './.'
  - tx -d push -s --skip --no-interactive
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-pull-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - cd './.'
  - tx -d pull -a --skip --minimum-perc=75 -f
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-writer-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - echo 'noop'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-cleanup-old
  pull: always
  image: owncloudci/transifex:latest
  commands:
  - echo 'noop'
  environment:
    TX_TOKEN:
      from_secret: tx_token

- name: translation-commit
  pull: always
  image: appleboy/drone-git-push:latest
  settings:
    author_email: devops@owncloud.com
    author_name: ownClouders
    branch: master
    commit: true
    commit_message: "[tx] updated from transifex"
    no_verify: true
    path: .
    remote: git@github.com:owncloud/android.git
    remote_name: upstream
    ssh_key:
      from_secret: git_push_ssh_key

trigger:
  event:
  - push
  ref:
  - refs/heads/master
  - refs/pull/**

---
kind: pipeline
type: docker
name: notification

platform:
  os: linux
  arch: amd64

clone:
  disable: true

steps:
- name: rocketchat
  pull: always
  image: plugins/slack:1
  settings:
    channel: server
    template: "*{{build.status}}* <{{build.link}}|{{repo.owner}}/{{repo.name}}#{{truncate build.commit 8}}>"
    webhook:
      from_secret: slack_webhook

trigger:
  event:
  - push
  status:
  - success
  - failure

depends_on:
- core
- activity
- announcementcenter
- brute_force_protection
- calendar
- contacts
- customgroups
- diagnostics
- external
- files_antivirus
- files_external_dropbox
- files_external_ftp
- files_external_gdrive
- files_paperhive
- files_texteditor
- firstrunwizard
- guests
- impersonate
- notes
- notifications
- oauth2
- password_policy
- richdocuments
- tasks
- templateeditor
- twofactor_backup_codes
- twofactor_privacyidea
- twofactor_totp
- user_ldap
- user_management
- encryption
- phoenix
- windows_phone
- ios-app
- ios-sdk
- ios-old
- android

...
